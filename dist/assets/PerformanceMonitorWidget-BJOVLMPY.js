import{r as o,j as t}from"./ui-d27jHJxv.js";import"./vendor-BerfLJhL.js";const f=()=>{const[c,x]=o.useState([]),[u,l]=o.useState("connecting"),s=o.useRef(null);o.useEffect(()=>{function n(){s.current=new WebSocket("ws://localhost:8000/metrics/stream"),l("connecting"),s.current.onopen=()=>l("connected"),s.current.onmessage=e=>{const r=JSON.parse(e.data);x(d=>[...d.slice(-59),r])},s.current.onclose=e=>{l("disconnected"),e.wasClean||console.error(`Performance Monitor WebSocket closed unexpectedly. Code: ${e.code}, Reason: "${e.reason}"`),setTimeout(n,5e3)},s.current.onerror=e=>{var r;console.error("Performance Monitor WebSocket Error. See the event object for details:",e),(r=s.current)==null||r.close()}}return n(),()=>{var e;return(e=s.current)==null?void 0:e.close()}},[]);const a=c[c.length-1]||{cpu_percent:0,memory_percent:0,api_response_time:0},m={connecting:{text:"Forbinder...",color:"bg-yellow-500"},connected:{text:"Forbundet",color:"bg-green-500"},disconnected:{text:"Forbindelse afbrudt",color:"bg-red-500"}},i=({label:n,value:e,unit:r})=>t.jsxs("div",{className:"text-center p-3 rounded-lg bg-gray-100 dark:bg-gray-700",children:[t.jsxs("div",{className:"text-2xl font-bold",children:[e.toFixed(1),r]}),t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:n})]});return t.jsx("div",{className:"h-full flex flex-col -m-4",children:t.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center justify-end gap-2 text-xs font-medium",children:[t.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${m[u].color}`}),t.jsx("span",{children:m[u].text})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsx(i,{label:"CPU",value:a.cpu_percent,unit:"%"}),t.jsx(i,{label:"Hukommelse",value:a.memory_percent,unit:"%"}),t.jsx(i,{label:"Svar tid",value:a.api_response_time,unit:"ms"})]}),t.jsx("div",{className:"h-20 rounded-lg p-2 flex items-end gap-0.5 bg-gray-100 dark:bg-gray-700",children:Array.from({length:60}).map((n,e)=>{const r=c[c.length-60+e],d=r?Math.min(100,r.cpu_percent):0;return t.jsx("div",{className:"flex-1 bg-blue-500 rounded-t-sm",style:{height:`${d}%`}},e)})})]})})};export{f as default};
