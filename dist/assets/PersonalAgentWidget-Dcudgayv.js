import{r as t,j as e,K as p,z as N,c as w,C as k,S,i as D,B as f,a as P}from"./ui-d27jHJxv.js";import"./vendor-BerfLJhL.js";const M=({userId:h})=>{const[o,l]=t.useState([]),[n,c]=t.useState(""),[i,m]=t.useState(!1),[x,b]=t.useState([]),u=t.useRef(null),j=[{id:"architect",name:"Architecture",icon:N,color:"#3b82f6"},{id:"security",name:"Security",icon:w,color:"#ef4444"},{id:"backend",name:"Backend",icon:k,color:"#10b981"},{id:"frontend",name:"Frontend",icon:S,color:"#f59e0b"}];t.useEffect(()=>{var r;(r=u.current)==null||r.scrollIntoView({behavior:"smooth"})},[o]);const g=async()=>{if(!n.trim())return;const r={id:Date.now().toString(),role:"user",content:n,timestamp:new Date};l(s=>[...s,r]),c(""),m(!0);try{const a=await(await fetch("/api/agent/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n,userId:h,context:{activePersonas:x,conversationHistory:o.slice(-5)}})})).json(),d={id:(Date.now()+1).toString(),role:"agent",content:a.response,timestamp:new Date,personas:a.personas_used,confidence:a.confidence};l(v=>[...v,d])}catch(s){console.error("Agent error:",s);const a={id:(Date.now()+1).toString(),role:"agent",content:"Beklager, jeg st√∏dte p√• en fejl. Pr√∏v venligst igen.",timestamp:new Date};l(d=>[...d,a])}finally{m(!1)}},y=r=>{b(s=>s.includes(r)?s.filter(a=>a!==r):[...s,r])};return e.jsxs("div",{className:"group flex flex-col h-full bg-card/5 backdrop-blur-sm rounded-lg border border-border/20 transition-all duration-300 hover:scale-[1.02] hover:-translate-y-1 shadow-[var(--shadow-card)] hover:shadow-[var(--shadow-hero)]",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/20 bg-gradient-to-r from-primary/5 to-primary-brand/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/20 rounded-lg animate-glow-pulse",children:e.jsx(p,{className:"w-6 h-6",style:{color:"hsl(var(--primary))"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Personal Agent"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L1 Director ‚Ä¢ Multi-Persona"})]})]}),e.jsx("div",{className:"flex gap-2",children:j.map(r=>{const s=r.icon,a=x.includes(r.id);return e.jsx("button",{onClick:()=>y(r.id),className:`p-2 rounded-lg transition-all duration-200 ${a?"bg-primary/30 ring-2 ring-primary scale-110":"bg-muted hover:bg-accent hover:scale-105"}`,title:r.name,children:e.jsx(s,{className:"w-4 h-4 transition-colors",style:{color:a?r.color:"hsl(var(--muted-foreground))"}})},r.id)})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-subtle",children:[o.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center animate-fade-in",children:[e.jsxs("div",{className:"p-6 bg-card/50 backdrop-blur-sm rounded-2xl border border-border/10 mb-4",children:[e.jsx(p,{className:"w-16 h-16 mb-4 mx-auto",style:{color:"hsl(var(--primary))"}}),e.jsx("h4",{className:"text-xl font-semibold text-card-foreground mb-2",children:"Din Personlige Agent"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Jeg kan hj√¶lpe med kodeanalyse, arkitektur, workflow-generering og meget mere. V√¶lg ekspert-personas ovenfor for specialiseret assistance."})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3 text-left",children:[e.jsxs("div",{className:"p-3 bg-accent/50 backdrop-blur rounded-lg border border-border/10 transition-transform hover:scale-105",children:[e.jsx("p",{className:"text-sm text-accent-foreground font-semibold",children:"üí° Pr√∏v:"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'"Analys√©r min kode for sikkerhedsrisici"'})]}),e.jsxs("div",{className:"p-3 bg-accent/50 backdrop-blur rounded-lg border border-border/10 transition-transform hover:scale-105",children:[e.jsx("p",{className:"text-sm text-accent-foreground font-semibold",children:"üéØ Eller:"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'"Generer en workflow fra min PRD"'})]})]})]}),o.map(r=>e.jsxs("div",{className:`flex gap-3 ${r.role==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center shadow-lg ${r.role==="user"?"bg-primary":"bg-gradient-primary"}`,children:r.role==="user"?e.jsx(D,{className:"w-5 h-5 text-primary-foreground"}):e.jsx(f,{className:"w-5 h-5 text-primary-foreground"})}),e.jsxs("div",{className:`flex-1 max-w-[80%] ${r.role==="user"?"items-end":"items-start"}`,children:[e.jsx("div",{className:`px-4 py-3 rounded-2xl backdrop-blur-sm transition-all ${r.role==="user"?"bg-primary text-primary-foreground shadow-[var(--shadow-button)]":"bg-card/70 text-card-foreground border border-border/20"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:r.content})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 px-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:r.timestamp.toLocaleTimeString("da-DK",{hour:"2-digit",minute:"2-digit"})}),r.personas&&r.personas.length>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["‚Ä¢ ",r.personas.join(", ")]}),r.confidence&&e.jsxs("span",{className:"text-xs text-success",children:["‚Ä¢ ",Math.round(r.confidence*100),"% confidence"]})]})]})]},r.id)),i&&e.jsxs("div",{className:"flex gap-3 animate-fade-in",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-primary flex items-center justify-center shadow-lg animate-glow-pulse",children:e.jsx(f,{className:"w-5 h-5 text-primary-foreground"})}),e.jsx("div",{className:"flex-1 px-4 py-3 bg-card/70 backdrop-blur-sm rounded-2xl border border-border/20",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce",style:{animationDelay:"0ms",backgroundColor:"hsl(var(--primary))"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce",style:{animationDelay:"150ms",backgroundColor:"hsl(var(--primary))"}}),e.jsx("div",{className:"w-2 h-2 rounded-full animate-bounce",style:{animationDelay:"300ms",backgroundColor:"hsl(var(--primary))"}})]})})]}),e.jsx("div",{ref:u})]}),e.jsx("div",{className:"p-4 border-t border-border/20 bg-gradient-to-r from-primary/5 to-primary-brand/5",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:r=>c(r.target.value),onKeyPress:r=>r.key==="Enter"&&g(),placeholder:"Stil mig et sp√∏rgsm√•l eller bed om hj√¶lp...",className:"flex-1 px-4 py-3 bg-input text-foreground rounded-lg border border-border focus:border-ring focus:ring-2 focus:ring-ring/50 outline-none transition-all",disabled:i}),e.jsx("button",{onClick:g,disabled:i||!n.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:e.jsx(P,{className:"w-5 h-5"})})]})})]})};export{M as PersonalAgentWidget,M as default};
