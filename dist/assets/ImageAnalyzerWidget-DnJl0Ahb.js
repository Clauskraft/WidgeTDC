import{r as l,j as e}from"./ui-d27jHJxv.js";import{G as w}from"./index-CHxrVzz6.js";import{B as P}from"./Button-CUGYQXiP.js";import"./vendor-BerfLJhL.js";var x={};const k=o=>new Promise((i,d)=>{const s=new FileReader;s.readAsDataURL(o),s.onload=()=>i(s.result.split(",")[1]),s.onerror=c=>d(c)}),S=()=>{const[o,i]=l.useState(null),[d,s]=l.useState(null),[c,h]=l.useState("Hvad er der på dette billede?"),[g,m]=l.useState(""),[p,u]=l.useState(!1),[f,n]=l.useState(null),b=a=>{var t;const r=(t=a.target.files)==null?void 0:t[0];r&&(i(r),s(URL.createObjectURL(r)),m(""),n(null))},y=l.useCallback(a=>{var t;a.preventDefault(),a.stopPropagation();const r=(t=a.dataTransfer.files)==null?void 0:t[0];r&&r.type.startsWith("image/")&&(i(r),s(URL.createObjectURL(r)),m(""),n(null))},[]),j=async()=>{if(!o||!x.API_KEY){n("Vælg venligst en fil og sørg for at API nøglen er sat.");return}u(!0),n(null),m("");try{const a=new w({apiKey:x.API_KEY}),r=await k(o),t={inlineData:{mimeType:o.type,data:r}},v={text:c},N=await a.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[t,v]}});m(N.text)}catch(a){console.error("Image analysis failed:",a),n("Analyse fejlede. Se konsollen for detaljer.")}finally{u(!1)}};return e.jsx("div",{className:"h-full flex flex-col -m-4",children:e.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto",children:[e.jsxs("div",{onDrop:y,onDragOver:a=>a.preventDefault(),className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500 dark:hover:border-blue-400",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"hidden",id:"image-upload"}),d?e.jsx("img",{src:d,alt:"Forhåndsvisning",className:"max-h-48 mx-auto rounded-md"}):e.jsxs("label",{htmlFor:"image-upload",className:"ms-focusable cursor-pointer",children:[e.jsx("p",{children:"Træk og slip et billede her, eller klik for at vælge"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, WEBP"})]})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:c,onChange:a=>h(a.target.value),placeholder:"Stil et spørgsmål om billedet...",rows:2,className:"ms-focusable w-full p-2 rounded-lg border bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600"}),e.jsx(P,{onClick:j,disabled:p,className:"w-full",children:p?"Analyserer...":"Analyser Billede"})]}),f&&e.jsx("p",{className:"text-red-500 text-sm",children:f}),g&&e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Analyse Resultat:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g})]})]})})};export{S as default};
