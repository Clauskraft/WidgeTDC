import{r as i,j as e}from"./ui-d27jHJxv.js";import"./vendor-BerfLJhL.js";const S=()=>{const[d,u]=i.useState("procurement-agent"),[r,l]=i.useState(null),[n,p]=i.useState([]),[h,x]=i.useState(!1),[c,g]=i.useState(""),y=async()=>{x(!0),g("");try{const t=await fetch("/api/mcp/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool:"evolution.analyze-prompts",payload:{agentId:d,limit:5},context:{orgId:"org-1",userId:"user-1"}})});if(t.ok){const o=await t.json();o.latestPrompt?l({agentId:o.agentId,version:o.latestPrompt.version,promptText:o.latestPrompt.text,createdAt:o.latestPrompt.createdAt,createdBy:"system"}):l(null),o.recentRuns&&p(o.recentRuns.map(a=>{var m;return{id:a.runId,agent_id:o.agentId,prompt_version:((m=o.latestPrompt)==null?void 0:m.version)||1,kpi_name:"Performance",kpi_delta:a.kpiDelta,created_at:a.timestamp}}))}else l(null),p([])}catch(t){g(t.message||"Failed to load agent data")}finally{x(!1)}};i.useEffect(()=>{y()},[d]);const s=n.length===0?0:n.reduce((o,a)=>o+a.kpi_delta,0)/n.length,f=s<0;return e.jsxs("div",{style:{padding:"20px",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#1a1a1a",color:"#ffffff"},children:[e.jsx("h2",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"600"},children:"Evolution & KPI Monitor"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px"},children:"Agent ID"}),e.jsxs("select",{value:d,onChange:t=>u(t.target.value),style:{width:"100%",padding:"10px",backgroundColor:"#2a2a2a",border:"1px solid #444",borderRadius:"4px",color:"#ffffff",fontSize:"14px"},children:[e.jsx("option",{value:"procurement-agent",children:"Procurement Agent"}),e.jsx("option",{value:"cma-agent",children:"CMA Agent"}),e.jsx("option",{value:"srag-agent",children:"SRAG Agent"}),e.jsx("option",{value:"pal-agent",children:"PAL Agent"})]})]}),c&&e.jsx("div",{style:{padding:"10px",backgroundColor:"#ff3333",borderRadius:"4px",marginBottom:"15px",fontSize:"14px"},children:c}),h?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#888"},children:"Loading agent data..."}):e.jsxs(e.Fragment,{children:[r?e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",margin:0},children:"Current Prompt"}),e.jsxs("div",{style:{padding:"4px 12px",backgroundColor:"#3b82f6",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:["v",r.version]})]}),e.jsx("div",{style:{backgroundColor:"#2a2a2a",borderRadius:"4px",padding:"12px",fontSize:"13px",maxHeight:"120px",overflowY:"auto"},children:r.promptText}),e.jsxs("div",{style:{fontSize:"11px",color:"#888",marginTop:"5px"},children:["Created by ",r.createdBy," • ",new Date(r.createdAt).toLocaleString()]})]}):e.jsx("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"4px",marginBottom:"20px",color:"#888",fontSize:"14px"},children:"No prompt found for this agent"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"10px"},children:"Performance Status"}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs("div",{style:{flex:1,padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"5px"},children:"Avg KPI Delta"}),e.jsxs("div",{style:{fontSize:"24px",fontWeight:"600",color:s>=0?"#10b981":"#ef4444"},children:[s>=0?"+":"",(s*100).toFixed(1),"%"]})]}),e.jsxs("div",{style:{flex:1,padding:"15px",backgroundColor:f?"#dc2626":"#10b981",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"12px",marginBottom:"5px"},children:"Status"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:"600"},children:f?"Needs Refinement":"Performing Well"})]})]})]}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsxs("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"10px"},children:["Recent Runs (",n.length,")"]}),n.length===0?e.jsx("div",{style:{padding:"20px",backgroundColor:"#2a2a2a",borderRadius:"4px",color:"#888",fontSize:"14px",textAlign:"center"},children:"No runs recorded yet"}):e.jsx("div",{style:{flex:1,backgroundColor:"#2a2a2a",borderRadius:"4px",padding:"10px",overflowY:"auto"},children:n.map(t=>e.jsxs("div",{style:{marginBottom:"10px",padding:"10px",backgroundColor:"#1a1a1a",borderRadius:"4px",borderLeft:`3px solid ${t.kpi_delta>=0?"#10b981":"#ef4444"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"13px",fontWeight:"600"},children:t.kpi_name}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"600",color:t.kpi_delta>=0?"#10b981":"#ef4444"},children:[t.kpi_delta>=0?"+":"",(t.kpi_delta*100).toFixed(1),"%"]})]}),e.jsxs("div",{style:{fontSize:"11px",color:"#888"},children:["Prompt v",t.prompt_version," • ",new Date(t.created_at).toLocaleString()]})]},t.id))})]})]})]})};export{S as default};
