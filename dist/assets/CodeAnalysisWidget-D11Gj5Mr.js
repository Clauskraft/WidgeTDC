import{r as n,j as e,c as x,C as f,U as j,d as v,T as u,F as N}from"./ui-d27jHJxv.js";import"./vendor-BerfLJhL.js";const S=()=>{const[c,o]=n.useState(!1),[r,i]=n.useState(null),[d,m]=n.useState(null),b=async s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];if(a){m(a),o(!0);try{const t=new FormData;t.append("file",a);const g=await(await fetch("/api/commands/sc/analyze",{method:"POST",body:t})).json();i(g)}catch(t){console.error("Analysis error:",t)}finally{o(!1)}}},h=s=>{switch(s){case"critical":return"bg-destructive/20 text-destructive border-destructive/50";case"high":return"bg-warning/20 text-warning border-warning/50";case"medium":return"bg-accent/20 text-accent-foreground border-accent/50";default:return"bg-primary/20 text-primary border-primary/50"}},p=s=>s>=80?"text-success":s>=60?"text-warning":"text-destructive";return e.jsxs("div",{className:"group flex flex-col h-full bg-card/5 backdrop-blur-sm rounded-lg border border-border/20 transition-all duration-300 hover:scale-[1.02] hover:-translate-y-1 shadow-[var(--shadow-card)] hover:shadow-[var(--shadow-hero)] overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b border-border/20 bg-gradient-to-r from-destructive/5 to-warning/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-destructive/20 rounded-lg animate-glow-pulse",children:e.jsx(x,{className:"w-6 h-6",style:{color:"hsl(var(--destructive))"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Code Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Security â€¢ Quality â€¢ Performance"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gradient-subtle",children:[!r&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center animate-fade-in",children:[e.jsxs("div",{className:"p-6 bg-card/50 backdrop-blur-sm rounded-2xl border border-border/10 mb-6",children:[e.jsx(f,{className:"w-16 h-16 mx-auto mb-4",style:{color:"hsl(var(--destructive))"}}),e.jsx("h4",{className:"text-xl font-semibold text-card-foreground mb-2",children:"Upload din kode for analyse"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md",children:"FÃ¥ Ã¸jeblikkelig feedback pÃ¥ sikkerhedsrisici, kodekvalitet og performance-problemer"}),e.jsxs("label",{className:"inline-flex items-center gap-2 btn-primary cursor-pointer",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"VÃ¦lg fil eller mappe"}),e.jsx("input",{type:"file",onChange:b,className:"hidden",accept:".js,.ts,.tsx,.jsx,.py,.java,.cs,.go",disabled:c})]}),c&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-muted-foreground animate-fade-in",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"hsl(var(--destructive))"}}),e.jsxs("span",{children:["Analyserer ",d==null?void 0:d.name,"..."]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-left",children:[e.jsxs("div",{className:"p-4 bg-destructive/10 backdrop-blur rounded-lg border border-destructive/20 transition-transform hover:scale-105",children:[e.jsx(x,{className:"w-8 h-8 mb-2",style:{color:"hsl(var(--destructive))"}}),e.jsx("p",{className:"text-sm font-semibold text-card-foreground",children:"Sikkerhed"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SQL injection, XSS, CSRF"})]}),e.jsxs("div",{className:"p-4 bg-success/10 backdrop-blur rounded-lg border border-success/20 transition-transform hover:scale-105",children:[e.jsx(v,{className:"w-8 h-8 mb-2",style:{color:"hsl(var(--success))"}}),e.jsx("p",{className:"text-sm font-semibold text-card-foreground",children:"Kvalitet"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Best practices, patterns"})]}),e.jsxs("div",{className:"p-4 bg-warning/10 backdrop-blur rounded-lg border border-warning/20 transition-transform hover:scale-105",children:[e.jsx(u,{className:"w-8 h-8 mb-2",style:{color:"hsl(var(--warning))"}}),e.jsx("p",{className:"text-sm font-semibold text-card-foreground",children:"Performance"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Loops, memory leaks"})]})]})]}),r&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"p-4 bg-card/50 backdrop-blur-sm rounded-lg border border-border/20 text-center transition-transform hover:scale-105",children:[e.jsx("div",{className:`text-3xl font-bold ${p(r.overallScore)}`,children:r.overallScore}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Samlet Score"})]}),e.jsxs("div",{className:"p-4 bg-destructive/10 backdrop-blur border border-destructive/30 rounded-lg text-center transition-transform hover:scale-105",children:[e.jsx("div",{className:"text-3xl font-bold text-destructive",children:r.summary.criticalIssues}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Critical"})]}),e.jsxs("div",{className:"p-4 bg-warning/10 backdrop-blur border border-warning/30 rounded-lg text-center transition-transform hover:scale-105",children:[e.jsx("div",{className:"text-3xl font-bold text-warning",children:r.summary.highIssues}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"High"})]}),e.jsxs("div",{className:"p-4 bg-accent/10 backdrop-blur border border-accent/30 rounded-lg text-center transition-transform hover:scale-105",children:[e.jsx("div",{className:"text-3xl font-bold text-accent-foreground",children:r.summary.mediumIssues}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Medium"})]}),e.jsxs("div",{className:"p-4 bg-primary/10 backdrop-blur border border-primary/30 rounded-lg text-center transition-transform hover:scale-105",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:r.summary.lowIssues}),e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Low"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-card-foreground mb-4",children:["Findings (",r.findings.length,")"]}),e.jsx("div",{className:"space-y-3",children:r.findings.map((s,a)=>e.jsxs("div",{className:`p-4 rounded-lg border backdrop-blur-sm transition-all hover:scale-[1.01] ${h(s.severity)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:s.category})]}),e.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold uppercase",children:s.severity})]}),e.jsx("p",{className:"text-card-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.file,":",s.line]})]}),e.jsxs("div",{className:"p-3 bg-success/10 backdrop-blur rounded border-l-4 border-success",children:[e.jsx("p",{className:"text-sm font-semibold text-success mb-1",children:"ðŸ’¡ Remediation:"}),e.jsx("p",{className:"text-sm text-card-foreground",children:s.remediation})]})]},a))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{i(null),m(null)},className:"btn-secondary",children:"Analyser ny fil"}),e.jsx("button",{onClick:()=>{const s=JSON.stringify(r,null,2),a=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`analysis-${Date.now()}.json`,t.click()},className:"btn-primary",children:"Download rapport"})]})]})]})]})};export{S as CodeAnalysisWidget,S as default};
