import{r as a,j as e,B as u,S as y,a as w}from"./ui-d27jHJxv.js";import{u as v}from"./useMCP-C6vkw6pp.js";import"./vendor-BerfLJhL.js";const S=({widgetId:B})=>{const{send:p}=v(),[r,l]=a.useState([]),[n,x]=a.useState(""),[i,m]=a.useState(!1),[d,b]=a.useState(!1),g=a.useRef(null);a.useEffect(()=>{var s;(s=g.current)==null||s.scrollIntoView({behavior:"smooth"})},[r]);const h=async()=>{if(!n.trim()||i)return;const s={id:`user-${Date.now()}`,content:n.trim(),sender:"user",timestamp:new Date};l(t=>[...t,s]);const j=n;x(""),m(!0);try{const t=await p("agent-orchestrator","srag.query",{naturalLanguageQuery:j,model:d?"deepseek-reasoner":"deepseek-chat",systemPrompt:"You are a specialized Agent focused on executing tasks."}),o={id:`agent-${Date.now()}`,content:t.response||t.content||JSON.stringify(t),sender:"agent",timestamp:new Date};l(c=>[...c,o])}catch(t){console.error("Chat error:",t);const o={id:`error-${Date.now()}`,content:`Fejl: Kunne ikke forbinde til agenten. ${t.message}`,sender:"agent",timestamp:new Date};l(c=>[...c,o])}finally{m(!1)}},f=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),h())};return e.jsxs("div",{className:"h-full flex flex-col -m-4","data-testid":"agent-chat-widget",children:[e.jsxs("div",{className:"p-3 border-b border-white/10 bg-[#0B3E6F]/20 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{size:18,className:"text-[#00B5CB]"}),e.jsx("h3",{className:"text-sm font-semibold text-white",children:"Agent Chat"})]}),e.jsxs("button",{onClick:()=>b(!d),className:`p-1.5 rounded-lg text-xs font-medium flex items-center gap-1 transition-colors ${d?"bg-purple-500/20 text-purple-300":"text-gray-400 hover:text-white"}`,title:"Aktiver dyb analyse (R1)",children:[e.jsx(y,{size:12})," Thinking"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[r.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500 text-xs",children:"Start en samtale med agenten..."}),r.map(s=>e.jsxs("div",{className:`flex items-end gap-2 ${s.sender==="user"?"justify-end":"justify-start"}`,children:[s.sender==="agent"&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#00B5CB]/20 flex items-center justify-center shrink-0",children:e.jsx(u,{size:12,className:"text-[#00B5CB]"})}),e.jsx("div",{className:`p-3 rounded-xl max-w-[85%] text-sm ${s.sender==="user"?"bg-[#00B5CB] text-[#051e3c] rounded-br-none":"bg-[#0B3E6F]/40 text-gray-200 border border-white/10 rounded-bl-none"}`,children:e.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:s.content})})]},s.id)),i&&e.jsxs("div",{className:"flex items-end gap-2 justify-start",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#00B5CB]/20 flex items-center justify-center shrink-0",children:e.jsx(u,{size:12,className:"text-[#00B5CB]"})}),e.jsx("div",{className:"p-3 rounded-xl bg-[#0B3E6F]/40 border border-white/10 rounded-bl-none",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-[#00B5CB] rounded-full animate-bounce"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-[#00B5CB] rounded-full animate-bounce delay-75"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-[#00B5CB] rounded-full animate-bounce delay-150"})]})})]}),e.jsx("div",{ref:g})]}),e.jsx("div",{className:"p-3 border-t border-white/10 bg-[#0B3E6F]/10",children:e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:n,onChange:s=>x(s.target.value),onKeyDown:f,placeholder:"Skriv besked...",className:"w-full bg-black/20 border border-white/10 rounded-xl py-3 pl-4 pr-12 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#00B5CB]/50 resize-none",rows:1,style:{minHeight:"44px"}}),e.jsx("button",{onClick:h,disabled:i||!n.trim(),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 bg-[#00B5CB] text-[#051e3c] rounded-lg hover:bg-[#009eb3] disabled:opacity-50 disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors",children:e.jsx(w,{size:14})})]})})]})};export{S as default};
