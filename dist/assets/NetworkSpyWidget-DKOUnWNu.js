import{r as a,j as e,A as p,R as f,W as u,G as j}from"./ui-d27jHJxv.js";import{u as b}from"./useMCP-C6vkw6pp.js";import{u as N}from"./useWidgetSync-PcBW9nb4.js";import"./vendor-BerfLJhL.js";const g={Google:"bg-blue-500",Microsoft:"bg-blue-400",Amazon:"bg-orange-500",Cloudflare:"bg-yellow-500",Unknown:"bg-gray-500"},C=({widgetId:h})=>{const{send:r}=b(),[s,c]=a.useState({connections:[],stats:{}}),[i,o]=a.useState(!1),[d,x]=a.useState(null);N(h,{activeConnections:s.connections.length,topProvider:Object.keys(s.stats)[0]||"None"});const n=a.useCallback(async()=>{o(!0),x(null);try{const t=await r("agent-orchestrator","widgets.network.scan",{});t&&t.data?c(t.data):c({connections:[],stats:{}})}catch(t){console.warn("Network scan failed:",t),x("Network Agent not connected")}finally{o(!1)}},[r]);a.useEffect(()=>{n();const t=setInterval(n,5e3);return()=>clearInterval(t)},[n]);const m=Object.entries(s.stats).sort((t,l)=>l[1]-t[1]);return e.jsxs("div",{className:"h-full flex flex-col","data-testid":"network-spy-widget",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{size:18,className:"text-[#00B5CB]"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Network Spy"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Active Connections"})]})]}),e.jsx("button",{onClick:n,disabled:i,className:`p-2 rounded-lg hover:bg-white/10 text-gray-300 transition-colors ${i?"animate-spin text-[#00B5CB]":""}`,children:e.jsx(f,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.jsxs("div",{className:"bg-[#0B3E6F]/20 rounded-lg p-2 border border-white/5 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase",children:"Active"}),e.jsx("p",{className:"text-lg font-bold text-green-400",children:s.connections.filter(t=>t.status==="established").length})]}),e.jsxs("div",{className:"bg-[#0B3E6F]/20 rounded-lg p-2 border border-white/5 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase",children:"Listening"}),e.jsx("p",{className:"text-lg font-bold text-blue-400",children:s.connections.filter(t=>t.status==="listening").length})]}),e.jsxs("div",{className:"bg-[#0B3E6F]/20 rounded-lg p-2 border border-white/5 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase",children:"Blocked"}),e.jsx("p",{className:"text-lg font-bold text-red-400",children:"0"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1",children:d?e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-center text-gray-500",children:[e.jsx(u,{size:32,className:"mb-2 opacity-20"}),e.jsx("p",{className:"text-sm font-medium",children:d}),e.jsx("p",{className:"text-xs mt-1",children:"Start Network Agent i backend"})]}):m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-center text-gray-500",children:[e.jsx(j,{size:32,className:"mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"Ingen aktivitet"})]}):m.map(([t,l])=>e.jsxs("div",{className:"relative group bg-[#0B3E6F]/20 rounded-lg overflow-hidden",children:[e.jsx("div",{className:`absolute inset-0 opacity-10 transition-all duration-500 ${g[t]||"bg-gray-500"}`,style:{width:`${l/s.connections.length*100}%`}}),e.jsxs("div",{className:"relative flex justify-between items-center p-3 z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${g[t]||"bg-gray-500"}`}),e.jsx("span",{className:"font-medium text-sm text-gray-200",children:t})]}),e.jsxs("span",{className:"text-xs font-mono text-gray-400",children:[l," conn"]})]})]},t))})]})};export{C as default};
