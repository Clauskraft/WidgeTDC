import{r as n,j as e,B,a4 as L,a5 as I,a6 as D,P as V}from"./ui-d27jHJxv.js";import{B as P}from"./Button-CUGYQXiP.js";import{u as O}from"./useWidgetSync-PcBW9nb4.js";import"./vendor-BerfLJhL.js";import"./useMCP-C6vkw6pp.js";function $(o,l){const[x,d]=n.useState(o);return n.useEffect(()=>{const g=setTimeout(()=>{d(o)},l);return()=>{clearTimeout(g)}},[o,l]),x}const y=[{name:"calculator",description:"Matematiske beregninger.",category:"Beregning"},{name:"public_search",description:"Søgning i offentlige kilder.",category:"Søgning"},{name:"private_search",description:"Søgning i interne kilder.",category:"Søgning"},{name:"gdpr_analyzer",description:"GDPR compliance analyse.",category:"Compliance"},{name:"code_interpreter",description:"Kør Python kode sikkert.",category:"Udvikling"},{name:"email_sender",description:"Send emails via Outlook.",category:"Kommunikation"}],G=({widgetId:o})=>{var N;const[l,x]=n.useState(""),[d,g]=n.useState(""),p=$(d,500),[j,v]=n.useState(y.map(t=>({...t,status:"optional"}))),[h,b]=n.useState(new Set),[S,w]=n.useState(!1),[c,C]=n.useState([]),[f,k]=n.useState(!0);O(o,{agentCount:c.length,lastAgent:(N=c[c.length-1])==null?void 0:N.name,draftName:l}),n.useEffect(()=>{async function t(){if(!p.trim()){v(y.map(a=>({...a,status:"optional"})));return}w(!0);try{const a=y.map(s=>{let r="optional";const i=p.toLowerCase();return i.includes("beregn")&&s.name==="calculator"&&(r="recommended"),i.includes("søg")&&s.name==="public_search"&&(r="recommended"),(i.includes("privat")||i.includes("intern"))&&(s.name==="private_search"&&(r="mandatory"),s.name==="public_search"&&(r="excluded")),i.includes("gdpr")&&s.name==="gdpr_analyzer"&&(r="mandatory"),i.includes("kode")&&s.name==="code_interpreter"&&(r="recommended"),i.includes("email")&&s.name==="email_sender"&&(r="recommended"),{...s,status:r}});v(a);const m=a.filter(s=>s.status==="mandatory").map(s=>s.name);b(s=>{const r=new Set([...s,...m]);return a.filter(u=>u.status==="excluded").map(u=>u.name).forEach(u=>r.delete(u)),r})}catch(a){console.error("Tool suggestion failed:",a)}finally{w(!1)}}t()},[p]);const A=()=>{const t={id:`agent-${Date.now()}`,name:l,instruction:d,tools:Array.from(h)};C(a=>[...a,t]),x(""),g(""),b(new Set)},_=t=>{const a=j.find(m=>m.name===t);!a||a.status==="mandatory"||a.status==="excluded"||b(m=>{const s=new Set(m);return s.has(t)?s.delete(t):s.add(t),s})},z=t=>({mandatory:"border-red-500/50 bg-red-500/10",recommended:"border-blue-500/50 bg-blue-500/10",excluded:"opacity-30 cursor-not-allowed",optional:"border-white/10 hover:border-white/20"})[t],T=t=>({mandatory:"bg-red-500/20 text-red-300",recommended:"bg-blue-500/20 text-blue-300",excluded:"bg-gray-500/20 text-gray-400",optional:"bg-white/10 text-gray-400"})[t],E=t=>({mandatory:"Krævet",recommended:"Anbefalet",excluded:"Ekskluderet",optional:"Valgfri"})[t];return e.jsxs("div",{className:"h-full flex flex-col -m-4","data-testid":"agent-builder-widget",children:[e.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(B,{size:20,className:"text-[#00B5CB]"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Agent Builder"})]}),e.jsxs("div",{className:"border-b border-white/10 pb-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer group",onClick:()=>k(!f),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 group-hover:text-white transition-colors",children:"Dine Agenter"}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-[#00B5CB]/20 text-[#00B5CB]",children:c.length})]}),e.jsx("button",{className:"p-1 rounded-full hover:bg-white/10 text-gray-400",children:f?e.jsx(L,{size:16}):e.jsx(I,{size:16})})]}),f&&e.jsx("div",{className:"mt-3 space-y-2 max-h-40 overflow-y-auto custom-scrollbar pr-1",children:c.length>0?c.map(t=>e.jsxs("div",{className:"p-3 bg-[#0B3E6F]/20 rounded-lg border border-white/5 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{size:16,className:"text-[#00B5CB]"}),e.jsx("p",{className:"font-medium text-sm text-white truncate",children:t.name})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:t.tools.length>0?t.tools.map(a=>e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium rounded bg-white/5 text-gray-300 capitalize",children:a.replace("_"," ")},a)):e.jsx("span",{className:"text-[10px] text-gray-500 italic",children:"Ingen værktøjer"})})]},t.id)):e.jsx("div",{className:"text-center py-4 text-xs text-gray-500 border border-dashed border-white/10 rounded-lg",children:"Ingen agenter oprettet endnu"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-400 mb-1 block",children:"Navn"}),e.jsx("input",{value:l,onChange:t=>x(t.target.value),placeholder:"Eks: Support Agent",className:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#00B5CB]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-400 mb-1 block",children:"Instruktion (Prompt)"}),e.jsx("textarea",{value:d,onChange:t=>g(t.target.value),placeholder:"Beskriv agentens opgave...",rows:3,className:"w-full bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#00B5CB] resize-none"})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-medium text-gray-400 mb-2 flex items-center gap-2",children:["Værktøjer",S&&e.jsx("div",{className:"w-3 h-3 border-2 border-[#00B5CB] border-t-transparent rounded-full animate-spin"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:j.map(t=>e.jsxs("div",{onClick:()=>_(t.name),className:`p-2 rounded-lg border flex flex-col gap-1 transition-all cursor-pointer ${z(t.status)} ${h.has(t.name)?"border-[#00B5CB] bg-[#00B5CB]/10":"bg-[#0B3E6F]/10"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(D,{size:12,className:"text-gray-400"}),e.jsx("span",{className:"text-xs font-medium text-gray-200 capitalize",children:t.name.replace("_"," ")})]}),h.has(t.name)&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-[#00B5CB]"})]}),e.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1",children:t.description}),e.jsx("div",{className:"mt-auto pt-1",children:e.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded-full font-medium ${T(t.status)}`,children:E(t.status)})})]},t.name))})]})]})]}),e.jsx("div",{className:"p-4 border-t border-white/10 bg-[#0B3E6F]/20",children:e.jsxs(P,{onClick:A,className:"w-full flex items-center justify-center gap-2 bg-[#00B5CB] hover:bg-[#009eb3] text-[#051e3c] font-semibold transition-colors",disabled:!l.trim()||!d.trim(),children:[e.jsx(V,{size:16})," Opret Agent"]})})]})};export{G as default};
