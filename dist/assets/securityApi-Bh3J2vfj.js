const n=typeof window<"u"?window.location.origin:"http://localhost:3001",c=n;async function i(t,e){const r=await fetch(`${c}${t}`,{headers:{"Content-Type":"application/json",...e==null?void 0:e.headers},...e});if(!r.ok)throw new Error(`Security API error ${r.status}`);return r.json()}async function s(){return i("/api/security/search/templates")}async function a(t=6){return i(`/api/security/search/history?limit=${t}`)}async function o(t){return i("/api/security/search/query",{method:"POST",body:JSON.stringify(t)})}async function y(t={}){const e=new URL("/api/security/activity",c);t.severity&&e.searchParams.set("severity",t.severity),t.category&&e.searchParams.set("category",t.category),t.limit&&e.searchParams.set("limit",String(t.limit));const r=await fetch(e.toString());if(!r.ok)throw new Error("Failed to fetch activity events");return r.json()}async function u(t,e){return i(`/api/security/activity/${t}/ack`,{method:"POST",body:JSON.stringify({acknowledged:e})})}function f(t,e){return new URL("/api/security/activity/stream",c).toString()}export{u as a,s as b,a as c,y as f,f as g,o as r};
