import{r as o,j as e,e as w,F as C,R as B,P as k,f as S,c as z,g as E,h as F}from"./ui-d27jHJxv.js";import{B as f}from"./Button-CUGYQXiP.js";import{u as L}from"./useMCP-C6vkw6pp.js";import"./vendor-BerfLJhL.js";const Q=({widgetId:I})=>{var p;const{send:n}=L(),[x,h]=o.useState([]),[u,m]=o.useState(!1),[i,b]=o.useState(""),[y,c]=o.useState(!1),[s,l]=o.useState({}),d=async()=>{m(!0);try{const t=await n("agent-orchestrator","notes.list",{});t&&t.notes&&h(t.notes)}catch(t){console.error("Failed to fetch notes:",t),h([])}finally{m(!1)}};o.useEffect(()=>{d()},[]);const j=async()=>{if(s.title)try{s.id?await n("agent-orchestrator","notes.update",{id:s.id,title:s.title,content:s.body,tags:s.tags}):await n("agent-orchestrator","notes.create",{title:s.title,content:s.body,tags:s.tags}),c(!1),l({}),d()}catch(t){console.error("Failed to save note:",t)}},N=async t=>{if(confirm("Er du sikker?"))try{await n("agent-orchestrator","notes.delete",{id:t}),d()}catch(r){console.error("Failed to delete note:",r)}},g=o.useMemo(()=>x.filter(t=>{var r,a;return t.title.toLowerCase().includes(i.toLowerCase())||((r=t.body)==null?void 0:r.toLowerCase().includes(i.toLowerCase()))||((a=t.tags)==null?void 0:a.some(v=>v.toLowerCase().includes(i.toLowerCase())))}),[x,i]);return y?e.jsxs("div",{className:"h-full flex flex-col p-4 bg-[#0B3E6F]/20",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.id?"Rediger Note":"Ny Note"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"subtle",size:"small",onClick:()=>c(!1),children:"Annuller"}),e.jsxs(f,{variant:"primary",size:"small",onClick:j,children:[e.jsx(w,{size:14,className:"mr-1"})," Gem"]})]})]}),e.jsx("input",{className:"bg-black/20 border border-white/10 rounded-lg p-2 mb-2 text-white placeholder-gray-400 focus:outline-none focus:border-[#00B5CB]",placeholder:"Titel",value:s.title||"",onChange:t=>l(r=>({...r,title:t.target.value}))}),e.jsx("textarea",{className:"flex-1 bg-black/20 border border-white/10 rounded-lg p-2 mb-2 text-white placeholder-gray-400 focus:outline-none focus:border-[#00B5CB] resize-none font-mono text-sm",placeholder:"Skriv dine tanker...",value:s.body||"",onChange:t=>l(r=>({...r,body:t.target.value}))}),e.jsx("input",{className:"bg-black/20 border border-white/10 rounded-lg p-2 text-white placeholder-gray-400 focus:outline-none focus:border-[#00B5CB] text-sm",placeholder:"Tags (komma separeret)",value:((p=s.tags)==null?void 0:p.join(", "))||"",onChange:t=>l(r=>({...r,tags:t.target.value.split(",").map(a=>a.trim())}))})]}):e.jsxs("div",{className:"h-full flex flex-col","data-testid":"intelligent-notes-widget",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(C,{size:18})," Noter"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:`p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-white transition-colors ${u?"animate-spin":""}`,children:e.jsx(B,{size:16})}),e.jsxs("button",{onClick:()=>{l({}),c(!0)},className:"px-3 py-1.5 bg-[#00B5CB] hover:bg-[#009eb3] text-[#051e3c] rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",children:[e.jsx(k,{size:16})," Ny"]})]})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Søg i noter...",value:i,onChange:t=>b(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg py-2 pl-9 pr-3 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#00B5CB]/50 transition-colors"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1",children:g.length>0?g.map(t=>{var r;return e.jsxs("div",{onClick:()=>{l(t),c(!0)},className:"p-3 bg-[#0B3E6F]/20 hover:bg-[#0B3E6F]/40 border border-white/5 hover:border-[#00B5CB]/30 rounded-xl transition-all cursor-pointer group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-200 group-hover:text-white truncate pr-2",children:t.title}),t.compliance!=="clean"&&e.jsx(z,{size:12,className:"text-amber-400 shrink-0"})]}),e.jsx("p",{className:"text-xs text-gray-400 line-clamp-2 mb-2",children:t.body}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-1",children:(r=t.tags)==null?void 0:r.slice(0,3).map(a=>e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 bg-white/5 rounded text-gray-400 flex items-center gap-1",children:[e.jsx(E,{size:8})," ",a]},a))}),e.jsx("button",{onClick:a=>{a.stopPropagation(),N(t.id)},className:"p-1 hover:bg-red-500/20 text-gray-500 hover:text-red-400 rounded opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(F,{size:12})})]})]},t.id)}):e.jsx("div",{className:"text-center py-8 text-gray-500 text-xs",children:u?"Indlæser...":"Ingen noter fundet"})})]})};export{Q as default};
