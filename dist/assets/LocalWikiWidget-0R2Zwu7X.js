import{r as c,j as e,o as k,f as S,c as b,P as C,p as E,S as f,e as z,q as T,s as D,D as I,t as j,F as A,u as P,v as L,w as R,x as F}from"./ui-d27jHJxv.js";import{s as M}from"./index-D3cQhnRP.js";import{u as G}from"./useWidgetSync-PcBW9nb4.js";import"./vendor-BerfLJhL.js";import"./grid-B9N6NCa2.js";import"./useMCP-C6vkw6pp.js";const U=[{id:"1",title:"WidgeTDC Arkitektur",category:"Teknisk",content:`# WidgeTDC Arkitektur

Dette projekt er bygget som en monorepo med React frontend og Node.js backend via MCP (Model Context Protocol).

## Komponenter
- **Widget Board**: Frontend dashboard
- **MCP Server**: Backend logik
- **Agents**: AI agenter der kører autonomt`,lastUpdated:"2025-11-27",tags:["arkitektur","react","mcp"],source:"manual",sensitivity:"public"},{id:"2",title:"Scraped Data: TDC Erhverv",category:"Market Research",content:`# Markedsanalyse

Data hentet fra offentlige kilder.

[Link til original kilde]

## Observationer
...`,lastUpdated:"2025-11-27",tags:["market","tdc","auto-generated"],source:"scraper",sensitivity:"internal",originalSourcePath:"/data/scrapes/tdc-2025-11-27.json"},{id:"3",title:"Kunde Email: Support Sag #1234",category:"Support",content:`Fra: [REDACTED]
Emne: Fejl ved login

Hej Support,

Jeg kan ikke logge ind på min konto [REDACTED]. Min CPR er [REDACTED].

Mvh,
[REDACTED]`,lastUpdated:"2025-11-26",tags:["support","login","pii-detected"],source:"email",sensitivity:"pii",ownerId:"current-user",attachments:[{id:"a1",name:"Fejlbesked.png",type:"image/png",size:"1.2 MB",accessLevel:"public"},{id:"a2",name:"Kontrakt_Udkast.pdf",type:"application/pdf",size:"450 KB",accessLevel:"owner",aiAnalysis:"Indeholder kontraktuelle data. Bør kun deles med omtanke."}]}],W=({text:i,sensitivity:l})=>l==="pii"||l==="confidential"?e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-2 font-semibold",children:[e.jsx(b,{size:16}),e.jsx("span",{children:"Privacy Shield Aktivt"})]}),e.jsx("p",{className:"text-xs text-red-300/80",children:"Dette indhold indeholder personfølsomme data (PII). Visse oplysninger er automatisk sløret for at overholde GDPR. Original data findes kun i kildesystemet (f.eks. Outlook) og er ikke kopieret her."})]}):null,B=({attachment:i,isOwner:l})=>{const[r,g]=c.useState(i.accessLevel),[s,x]=c.useState(!1),m=l||r==="public"||r==="team";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg border border-white/5 group hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded text-blue-400",children:e.jsx(j,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-200 group-hover:text-white",children:i.name}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[e.jsx("span",{children:i.size}),e.jsx("span",{children:"•"}),e.jsx("span",{className:`uppercase ${r==="owner"?"text-red-400":r==="team"?"text-yellow-400":"text-green-400"}`,children:r==="owner"?"Privat":r==="team"?"Team":"Offentlig"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i.aiAnalysis&&l&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>x(!s),className:"p-1.5 hover:bg-white/10 rounded text-purple-400 transition-colors",title:"AI Analyse",children:e.jsx(f,{size:14})}),s&&e.jsxs("div",{className:"absolute right-0 top-8 w-64 bg-[#0B3E6F] border border-white/20 rounded-xl p-3 shadow-2xl z-10 text-xs",children:[e.jsx("p",{className:"text-purple-300 font-semibold mb-1",children:"AI Anbefaling"}),e.jsx("p",{className:"text-gray-300 mb-2",children:i.aiAnalysis}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"flex-1 py-1 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded flex items-center justify-center gap-1",children:[e.jsx(P,{size:12})," Enig"]}),e.jsxs("button",{className:"flex-1 py-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded flex items-center justify-center gap-1",children:[e.jsx(L,{size:12})," Uenig"]})]})]})]}),l?e.jsx("button",{onClick:()=>g(r==="owner"?"public":"owner"),className:`p-1.5 rounded transition-colors ${r==="owner"?"hover:bg-green-500/20 text-gray-400 hover:text-green-400":"hover:bg-red-500/20 text-green-400 hover:text-red-400"}`,title:r==="owner"?"Gør offentlig":"Gør privat",children:r==="owner"?e.jsx(R,{size:14}):e.jsx(F,{size:14})}):!m&&e.jsx("div",{title:"Ingen adgang",children:e.jsx(b,{size:14,className:"text-red-500"})})]})]})};function Q(){const[i,l]=c.useState(U),[r,g]=c.useState(""),[s,x]=c.useState(null),[m,p]=c.useState(!1),[h,u]=c.useState(!1);G("local-wiki",{activeArticle:s==null?void 0:s.title,articleCount:i.length,searchQuery:r,recentTags:s==null?void 0:s.tags});const v="current-user",y=i.filter(t=>t.title.toLowerCase().includes(r.toLowerCase())||t.tags.some(n=>n.toLowerCase().includes(r.toLowerCase()))),N=()=>{p(!1),console.log("Gemmer metadata...")},w=async t=>{if(!h){u(!0);try{const d=(await M({providerId:"ollama",modelId:"llama3.2"},[{role:"system",content:"Du er en metadata generator. Generer 3-5 relevante tags for følgende tekst. Svar KUN med tags separeret af komma."},{role:"user",content:t.content.substring(0,500)}])).content.split(",").map(a=>a.trim());l(a=>a.map(o=>o.id===t.id?{...o,tags:[...new Set([...o.tags,...d])]}:o)),(s==null?void 0:s.id)===t.id&&x(a=>a?{...a,tags:[...new Set([...a.tags,...d])]}:null)}catch(n){console.error("Fejl ved generering af tags:",n),setTimeout(()=>{const d=["auto-tag-1","ai-analyse","indhold"];l(a=>a.map(o=>o.id===t.id?{...o,tags:[...new Set([...o.tags,...d])]}:o)),(s==null?void 0:s.id)===t.id&&x(a=>a?{...a,tags:[...new Set([...a.tags,...d])]}:null),u(!1)},1e3)}finally{u(!1)}}};return e.jsxs("div",{className:"flex h-full bg-[#0B3E6F]/30 backdrop-blur-md border border-white/10 rounded-2xl overflow-hidden text-white",children:[e.jsxs("div",{className:"w-1/3 border-r border-white/10 flex flex-col bg-black/10",children:[e.jsxs("div",{className:"p-4 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center text-orange-400",children:e.jsx(k,{size:18})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg leading-none",children:"Vidensbase"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Indekseret fra filer & systemer"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:14}),e.jsx("input",{type:"text",placeholder:"Søg i viden...",value:r,onChange:t=>g(t.target.value),className:"w-full bg-white/5 border border-white/10 rounded-lg py-2 pl-9 pr-3 text-sm focus:outline-none focus:border-orange-500/50 transition-colors"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:y.map(t=>e.jsxs("button",{onClick:()=>{x(t),p(!1)},className:`w-full text-left p-3 rounded-lg transition-all group hover:bg-white/5 ${(s==null?void 0:s.id)===t.id?"bg-white/10 border border-white/5":"border border-transparent"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:`text-sm font-medium truncate pr-2 ${(s==null?void 0:s.id)===t.id?"text-orange-400":"text-gray-200"}`,children:t.title}),t.sensitivity==="pii"&&e.jsx(b,{size:12,className:"text-red-400 shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`text-[9px] px-1.5 py-0.5 rounded border ${t.source==="scraper"?"bg-blue-500/10 border-blue-500/20 text-blue-300":t.source==="email"?"bg-purple-500/10 border-purple-500/20 text-purple-300":"bg-white/5 border-white/10 text-gray-400"}`,children:t.source==="scraper"?"Scraper":t.source==="email"?"Email":"Manuel"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:t.lastUpdated})]})]},t.id))}),e.jsx("div",{className:"p-3 border-t border-white/10",children:e.jsxs("button",{className:"w-full py-2 flex items-center justify-center gap-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-sm font-medium transition-colors",children:[e.jsx(C,{size:16})," Ny Manuel Artikel"]})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-[#051e3c]/20",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-14 border-b border-white/10 flex items-center justify-between px-6 bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-2 py-1 rounded bg-orange-500/10 text-orange-400 text-xs font-medium border border-orange-500/20",children:s.category}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{size:12,className:"text-gray-500"}),s.tags.map(t=>e.jsx("span",{className:"text-[10px] bg-white/5 px-1.5 py-0.5 rounded text-gray-300",children:t},t)),e.jsx("button",{onClick:()=>w(s),disabled:h,className:"ml-2 p-1 hover:bg-white/10 rounded text-orange-400 transition-colors",title:"Generer Tags med AI",children:e.jsx(f,{size:12,className:h?"animate-spin":""})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.source==="manual"&&(m?e.jsx("button",{onClick:N,className:"p-2 hover:bg-green-500/20 text-green-400 rounded-lg transition-colors",title:"Gem",children:e.jsx(z,{size:18})}):e.jsx("button",{onClick:()=>p(!0),className:"p-2 hover:bg-white/10 text-gray-400 hover:text-white rounded-lg transition-colors",title:"Rediger",children:e.jsx(T,{size:18})})),e.jsx("button",{className:"p-2 hover:bg-white/10 text-gray-400 hover:text-white rounded-lg transition-colors",title:"Del",children:e.jsx(D,{size:18})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 relative",children:[s.source!=="manual"&&e.jsxs("div",{className:"absolute top-4 right-8 flex items-center gap-2 text-xs text-gray-500 bg-black/20 px-3 py-1.5 rounded-full",children:[e.jsx(I,{size:12}),e.jsxs("span",{children:["Læser fra: ",s.originalSourcePath||"Ekstern kilde"]})]}),e.jsx(W,{text:s.content,sensitivity:s.sensitivity}),m?e.jsx("textarea",{className:"w-full h-full bg-transparent border-none focus:ring-0 text-gray-200 font-mono text-sm resize-none",defaultValue:s.content}):e.jsx("div",{className:"prose prosem-sm prose-invert max-w-none",children:s.content.split(`
`).map((t,n)=>{if(t.startsWith("# "))return e.jsx("h1",{className:"text-2xl font-bold mb-4 text-white",children:t.replace("# ","")},n);if(t.startsWith("## "))return e.jsx("h2",{className:"text-xl font-semibold mt-6 mb-3 text-orange-200",children:t.replace("## ","")},n);if(t.startsWith("- "))return e.jsx("li",{className:"ml-4 text-gray-300",children:t.replace("- ","")},n);if(t.match(/^\d\./))return e.jsx("div",{className:"ml-4 text-gray-300 mb-1",children:t},n);if(t==="")return e.jsx("br",{},n);const d=t.replace(/\[REDACTED\]/g,'<span class="bg-red-500/20 text-red-300 px-1 rounded text-xs font-mono">[SLØRET]</span>');return e.jsx("p",{className:"text-gray-300 mb-2 leading-relaxed",dangerouslySetInnerHTML:{__html:d}},n)})}),s.attachments&&s.attachments.length>0&&e.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(j,{size:14})," Vedhæftede Filer"]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:s.attachments.map(t=>e.jsx(B,{attachment:t,isOwner:s.ownerId===v},t.id))})]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(A,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{children:"Vælg en artikel for at se indhold"}),e.jsx("p",{className:"text-xs mt-2 text-gray-600",children:"Data indlæses direkte fra kildesystemer uden duplikering"})]})})]})}export{Q as default};
