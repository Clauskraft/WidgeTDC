import{j as e}from"./index-DZEoTVC4.js";import{r as a,H as m,x,P as N,a as C,T as D,I as W,F as w,y as h}from"./ui-DyG0g13d.js";import{M as j}from"./MatrixWidgetWrapper-mghho8C4.js";import{u as T}from"./useWidgetSync-DeOUJzf9.js";import{u as v}from"./useMCP-CI-td5l2.js";import"./vendor-Cv91Oj79.js";import"./graph-i8PIyU_l.js";import"./grid-BAREo1Ej.js";const S={path:"C:\\Users\\Public",depth:2,keywords:["password","secret","key","token"],intervalMin:30},z=({widgetId:b})=>{v();const[i,r]=a.useState(S),[l,c]=a.useState([]),[t,u]=a.useState(!1),[n,g]=a.useState(null),[o,p]=a.useState(!1);T(b,{isScanning:t,findingsCount:l.length});const f=a.useCallback(async()=>{if(i.path){u(!0),g(null),c([]);try{await new Promise(d=>setTimeout(d,2e3)),c([{name:"config.json",sizeBytes:1024,snippet:'"apiKey": "sk-...", "secret": "..."',threatScore:9,fullPath:"C:\\Users\\Public\\config.json"},{name:"notes.txt",sizeBytes:512,snippet:"Remember to rotate password for db",threatScore:4,fullPath:"C:\\Users\\Public\\notes.txt"},{name:"diagram.png",sizeBytes:204800,snippet:"",threatScore:1,hasImage:!0,fullPath:"C:\\Users\\Public\\diagram.png"}])}catch{g("Scan failed. Agent unreachable.")}finally{u(!1)}}},[i]);return e.jsxDEV(j,{title:"Local System Scanner",controls:e.jsxDEV("button",{onClick:()=>p(!o),className:`p-1 hover:text-[#00B5CB] transition-colors ${o?"text-[#00B5CB]":"text-gray-400"}`,children:e.jsxDEV(h,{size:14},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:77,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:73,columnNumber:13},void 0),children:e.jsxDEV("div",{className:"flex flex-col h-full",children:[o&&e.jsxDEV("div",{className:"mb-4 p-3 bg-white/5 border border-white/10 rounded-xl space-y-3 animate-slide-down",children:[e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV("div",{className:"flex-1 relative",children:[e.jsxDEV(m,{size:14,className:"absolute left-3 top-2.5 text-gray-500"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:88,columnNumber:25},void 0),e.jsxDEV("input",{type:"text",value:i.path,onChange:s=>r({...i,path:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-lg pl-9 pr-3 py-1.5 text-xs text-white focus:border-[#00B5CB] focus:outline-none",placeholder:"Path to scan..."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:89,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:87,columnNumber:21},void 0),e.jsxDEV("select",{value:i.depth,onChange:s=>r({...i,depth:parseInt(s.target.value)}),className:"bg-black/40 border border-white/10 rounded-lg px-2 py-1.5 text-xs text-gray-300 focus:outline-none",children:[1,2,3].map(s=>e.jsxDEV("option",{value:s,children:["Depth: ",s]},s,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:102,columnNumber:43},void 0))},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:97,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:86,columnNumber:17},void 0),e.jsxDEV("div",{children:e.jsxDEV("input",{type:"text",value:i.keywords.join(", "),onChange:s=>r({...i,keywords:s.target.value.split(",").map(d=>d.trim())}),className:"w-full bg-black/40 border border-white/10 rounded-lg px-3 py-1.5 text-xs text-white focus:border-[#00B5CB] focus:outline-none",placeholder:"Keywords: password, secret..."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:106,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:105,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:85,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[e.jsxDEV("div",{className:"flex items-center gap-2 text-gray-400 text-xs",children:[e.jsxDEV(x,{size:16,className:t?"text-[#00B5CB] animate-pulse":""},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:120,columnNumber:17},void 0),e.jsxDEV("span",{children:t?"Scanning file system...":"Ready to scan target"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:121,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:119,columnNumber:13},void 0),e.jsxDEV("button",{onClick:f,disabled:t,className:`
                    flex items-center gap-2 px-4 py-1.5 rounded-lg text-xs font-bold transition-all
                    ${t?"bg-white/5 text-gray-500 cursor-not-allowed":"bg-[#00B5CB]/20 text-[#00B5CB] hover:bg-[#00B5CB]/30 hover:scale-105 border border-[#00B5CB]/50"}
                `,children:[t?e.jsxDEV(N,{size:12},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:133,columnNumber:31},void 0):e.jsxDEV(C,{size:12},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:133,columnNumber:53},void 0),t?"SCANNING":"START SCAN"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:123,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:118,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1 custom-scrollbar",children:[n&&e.jsxDEV("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-xs flex items-center gap-2",children:[e.jsxDEV(D,{size:14},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:142,columnNumber:21},void 0)," ",n]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:141,columnNumber:17},void 0),l.length===0&&!t&&!n&&e.jsxDEV("div",{className:"h-32 flex flex-col items-center justify-center text-center border border-dashed border-white/10 rounded-xl",children:[e.jsxDEV("div",{className:"w-10 h-10 rounded-full bg-white/5 flex items-center justify-center mb-2",children:e.jsxDEV(m,{size:20,className:"text-gray-600"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:149,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:148,columnNumber:21},void 0),e.jsxDEV("p",{className:"text-xs text-gray-500",children:"No files scanned yet."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:151,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:147,columnNumber:17},void 0),l.map((s,d)=>e.jsxDEV("div",{className:"group p-3 bg-white/5 border border-white/5 hover:border-white/20 rounded-xl transition-all",children:[e.jsxDEV("div",{className:"flex justify-between items-start mb-1",children:[e.jsxDEV("div",{className:"flex items-center gap-2 overflow-hidden",children:[s.hasImage?e.jsxDEV(W,{size:14,className:"text-purple-400 shrink-0"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:159,columnNumber:48},void 0):e.jsxDEV(w,{size:14,className:"text-blue-400 shrink-0"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:159,columnNumber:111},void 0),e.jsxDEV("span",{className:"text-sm font-medium text-gray-200 truncate",title:s.fullPath,children:s.name},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:160,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:158,columnNumber:25},void 0),e.jsxDEV("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${s.threatScore>7?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"}`,children:["RISK: ",s.threatScore]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:162,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:157,columnNumber:21},void 0),e.jsxDEV("p",{className:"text-[10px] text-gray-500 font-mono truncate mb-2 opacity-60 group-hover:opacity-100 transition-opacity",children:s.fullPath},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:169,columnNumber:21},void 0),s.snippet&&e.jsxDEV("div",{className:"bg-black/30 p-2 rounded border border-white/5 text-[10px] text-gray-400 font-mono overflow-hidden text-ellipsis whitespace-nowrap",children:s.snippet},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:174,columnNumber:25},void 0)]},d,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:156,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:139,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:81,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/LocalScanWidget.tsx",lineNumber:70,columnNumber:5},void 0)};export{z as default};
