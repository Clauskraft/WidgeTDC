import{j as e}from"./index-DZEoTVC4.js";import{r as c,A as x,Z as N,f as C}from"./ui-DyG0g13d.js";import{M as W}from"./MatrixWidgetWrapper-mghho8C4.js";import"./vendor-Cv91Oj79.js";import"./graph-i8PIyU_l.js";import"./grid-BAREo1Ej.js";const T=()=>{const[o,p]=c.useState([]),[l,d]=c.useState("connecting"),n=c.useRef(null);c.useEffect(()=>{function a(){d("connecting");let t;try{const r=new WebSocket("ws://localhost:8000/metrics/stream");r.onopen=()=>{d("connected"),n.current=r},r.onmessage=g=>{try{const f=JSON.parse(g.data);p(b=>[...b.slice(-59),f])}catch(f){console.error("Parse error",f)}},r.onclose=()=>{d("disconnected"),s()},r.onerror=()=>{d("disconnected"),r.close()}}catch{s()}function s(){d("connected"),t=setInterval(()=>{const r={cpu_percent:20+Math.random()*15,memory_percent:40+Math.random()*5,api_response_time:45+Math.random()*20};p(g=>[...g.slice(-59),r])},1e3)}return()=>{n.current&&n.current.close(),t&&clearInterval(t)}}const i=a();return()=>{typeof i=="function"&&i(),n.current&&n.current.close()}},[]);const u=o[o.length-1]||{cpu_percent:0,memory_percent:0,api_response_time:0},m=({label:a,value:i,unit:t,icon:s,color:r})=>e.jsxDEV("div",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-white/5 border border-white/10 relative overflow-hidden",children:[e.jsxDEV("div",{className:`absolute top-0 right-0 p-1 opacity-20 ${r}`,children:e.jsxDEV(s,{size:32},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:237,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:234,columnNumber:11},void 0),e.jsxDEV("div",{className:`text-xl font-bold text-white z-10 ${r.replace("bg-","text-").replace("/20","")}`,children:[i.toFixed(1),e.jsxDEV("span",{className:"text-xs text-gray-500 ml-0.5",children:t},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:246,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:243,columnNumber:11},void 0),e.jsxDEV("div",{className:"text-[10px] uppercase tracking-wider text-gray-400 z-10 mt-1",children:a},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:252,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:231,columnNumber:7},void 0);return e.jsxDEV(W,{title:"Real-time Performance",children:e.jsxDEV("div",{className:"flex flex-col h-full gap-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between text-[10px] text-gray-500 px-1",children:[e.jsxDEV("span",{children:"STREAM SOURCE: WEBSOCKET"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:279,columnNumber:12},void 0),e.jsxDEV("div",{className:"flex items-center gap-1.5",children:[e.jsxDEV("div",{className:`w-1.5 h-1.5 rounded-full ${l==="connected"?"bg-green-400 animate-pulse":"bg-red-400"}`},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:285,columnNumber:17},void 0),e.jsxDEV("span",{className:l==="connected"?"text-green-400":"text-red-400",children:l.toUpperCase()},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:288,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:282,columnNumber:12},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:276,columnNumber:9},void 0),e.jsxDEV("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxDEV(m,{label:"CPU Load",value:u.cpu_percent,unit:"%",icon:x,color:"text-blue-400"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:312,columnNumber:13},void 0),e.jsxDEV(m,{label:"Memory",value:u.memory_percent,unit:"%",icon:N,color:"text-purple-400"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:315,columnNumber:13},void 0),e.jsxDEV(m,{label:"Latency",value:u.api_response_time,unit:"ms",icon:C,color:"text-yellow-400"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:318,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:309,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex-1 bg-black/20 rounded-xl border border-white/5 p-2 flex flex-col",children:e.jsxDEV("div",{className:"flex items-end justify-between h-full gap-[2px]",children:Array.from({length:40}).map((a,i)=>{Math.floor(i*(o.length/40));const t=o[o.length-40+i],s=t?Math.min(100,t.cpu_percent*1.5):5;return e.jsxDEV("div",{className:"flex-1 flex flex-col justify-end h-full group relative",children:[e.jsxDEV("div",{className:"absolute bottom-full mb-1 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[9px] px-1 py-0.5 rounded opacity-0 group-hover:opacity-100 pointer-events-none whitespace-nowrap z-20",children:[t==null?void 0:t.cpu_percent.toFixed(0),"%"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:363,columnNumber:30},void 0),e.jsxDEV("div",{className:`w-full rounded-t-[1px] transition-all duration-300 ${s>80?"bg-red-500/80 shadow-[0_0_10px_rgba(239,68,68,0.5)]":s>50?"bg-[#00B5CB]/80 shadow-[0_0_10px_rgba(0,181,203,0.5)]":"bg-[#00B5CB]/40"}`,style:{height:`${s}%`}},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:372,columnNumber:29},void 0)]},i,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:357,columnNumber:25},void 0)})},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:333,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:330,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:270,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/PerformanceMonitorWidget.tsx",lineNumber:267,columnNumber:5},void 0)};export{T as default};
