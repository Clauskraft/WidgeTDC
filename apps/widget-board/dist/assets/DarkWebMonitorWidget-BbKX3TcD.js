import{j as e}from"./index-DZEoTVC4.js";import{r as i,G as b,O as D,E as W,R as f}from"./ui-DyG0g13d.js";import{M as p}from"./MatrixWidgetWrapper-mghho8C4.js";import{u as x}from"./useMCP-CI-td5l2.js";import"./vendor-Cv91Oj79.js";import"./graph-i8PIyU_l.js";import"./grid-BAREo1Ej.js";const N=i.createContext(null),C=()=>{const s=i.useContext(N);if(!s)throw new Error("useWidgetBridge must be used within WidgetBridgeProvider");return s},w={feeds:[],threats:[],metrics:{totalThreats:0,avgPriceUSD:0,leakVelocity:0,resolutionRate:0}},T={low:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20",medium:"bg-amber-500/10 text-amber-400 border-amber-500/20",high:"bg-orange-500/10 text-orange-400 border-orange-500/20",critical:"bg-red-500/10 text-red-400 border-red-500/20"},y=({widgetId:s})=>{const{reportStatus:o}=C(),{send:n}=x(),[l,c]=i.useState(!1),[r,a]=i.useState(w),[h,g]=i.useState(null),[m,u]=i.useState(null),d=i.useCallback(async()=>{c(!0),g(null);try{const t=await n("agent-orchestrator","widgets.threat.hunt",{target:"company.com",category:"all"});t&&t.data?(a(t.data),u(new Date().toLocaleTimeString())):(a({feeds:[],threats:[{id:"1",feedId:"f1",title:"Database Dump Detected",description:"SQL dump found on BreachedForums containing partial user records.",severity:"high",leakedDataType:"SQL",priceUSD:500,detectedAt:new Date().toISOString(),affectedEntities:1500},{id:"2",feedId:"f2",title:"Employee Credentials",description:"3 valid RDP credentials for sub-domain found in Telegram channel.",severity:"critical",leakedDataType:"Credentials",priceUSD:150,detectedAt:new Date().toISOString(),affectedEntities:3}],metrics:{totalThreats:2,avgPriceUSD:325,leakVelocity:1.5,resolutionRate:85}}),u(new Date().toLocaleTimeString()))}catch(t){console.error("Failed to fetch Dark Web data:",t),a({feeds:[],threats:[{id:"mock-1",feedId:"m1",title:"Mock Threat: API Key Leak",description:"GitHub gist scan found potential AWS keys.",severity:"medium",leakedDataType:"API Key",priceUSD:0,detectedAt:new Date().toISOString(),affectedEntities:1}],metrics:{totalThreats:1,avgPriceUSD:0,leakVelocity:0,resolutionRate:0}})}finally{c(!1)}},[n]);return i.useEffect(()=>{d();const t=setInterval(d,3e5);return()=>clearInterval(t)},[d]),i.useEffect(()=>{const t=`Found ${r.metrics.totalThreats} threats.`;o(s,"Dark Web Monitor",t,r)},[r,s,o]),e.jsxDEV(p,{title:"Dark Web Monitor",isLoading:l&&r.metrics.totalThreats===0,controls:e.jsxDEV("div",{className:"flex items-center gap-2 text-[10px] text-gray-500",children:[e.jsxDEV("span",{children:m},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:137,columnNumber:13},void 0),e.jsxDEV("button",{onClick:d,className:"hover:text-[#00B5CB]",children:e.jsxDEV(f,{size:14,className:l?"animate-spin":""},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:139,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:138,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:136,columnNumber:9},void 0),children:e.jsxDEV("div",{className:"flex flex-col gap-4",children:[e.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxDEV("div",{className:"bg-white/5 border border-white/10 rounded-lg p-2 flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-[10px] text-gray-400 uppercase",children:"Total Threats"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:149,columnNumber:23},void 0),e.jsxDEV("div",{className:"text-xl font-bold text-white",children:r.metrics.totalThreats},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:150,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:148,columnNumber:19},void 0),e.jsxDEV(b,{className:"text-[#00B5CB] opacity-50",size:24},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:152,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:147,columnNumber:15},void 0),e.jsxDEV("div",{className:"bg-white/5 border border-white/10 rounded-lg p-2 flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-[10px] text-gray-400 uppercase",children:"Avg Price"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:156,columnNumber:23},void 0),e.jsxDEV("div",{className:"text-xl font-bold text-white",children:["$",r.metrics.avgPriceUSD]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:157,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:155,columnNumber:20},void 0),e.jsxDEV(D,{className:"text-red-400 opacity-50",size:24},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:159,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:154,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:146,columnNumber:11},void 0),e.jsxDEV("div",{className:"flex flex-col gap-2",children:[e.jsxDEV("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-1",children:"Recent Intelligence"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:165,columnNumber:13},void 0),r.threats.length===0?e.jsxDEV("div",{className:"p-4 text-center text-gray-500 text-xs border border-dashed border-white/10 rounded",children:"No active threats detected via feeds."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:167,columnNumber:17},void 0):r.threats.map(t=>e.jsxDEV("div",{className:"bg-white/5 border border-white/10 hover:border-white/20 transition-colors p-3 rounded-lg group",children:[e.jsxDEV("div",{className:"flex justify-between items-start mb-1",children:[e.jsxDEV("span",{className:"text-sm font-semibold text-gray-200 group-hover:text-white transition-colors",children:t.title},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:174,columnNumber:29},void 0),e.jsxDEV("span",{className:`text-[10px] font-bold uppercase px-1.5 py-0.5 rounded border ${T[t.severity]}`,children:t.severity},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:175,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:173,columnNumber:25},void 0),e.jsxDEV("p",{className:"text-xs text-gray-400 mb-2 line-clamp-2",children:t.description},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:179,columnNumber:25},void 0),e.jsxDEV("div",{className:"flex items-center justify-between text-[10px] text-gray-500 border-t border-white/5 pt-2 mt-1",children:[e.jsxDEV("span",{children:["Detected: ",new Date(t.detectedAt).toLocaleDateString()]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:181,columnNumber:29},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV("span",{className:"font-mono text-[#00B5CB]",children:["$",t.priceUSD]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:183,columnNumber:33},void 0),e.jsxDEV("button",{className:"hover:text-white transition-colors",children:e.jsxDEV(W,{size:12},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:184,columnNumber:88},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:184,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:182,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:180,columnNumber:25},void 0)]},t.id,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:172,columnNumber:21},void 0))]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:164,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:144,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/DarkWebMonitorWidget.tsx",lineNumber:132,columnNumber:5},void 0)};export{y as default};
