import{j as e}from"./index-DZEoTVC4.js";import{r,T as v,C,R as D}from"./ui-DyG0g13d.js";import{M as W}from"./MatrixWidgetWrapper-mghho8C4.js";import"./vendor-Cv91Oj79.js";import"./graph-i8PIyU_l.js";import"./grid-BAREo1Ej.js";const U=()=>{const[s,f]=r.useState("procurement-agent"),[d,l]=r.useState(null),[n,g]=r.useState([]),[N,c]=r.useState(!1),[m,p]=r.useState(""),b=async()=>{c(!0),p("");try{const t=await fetch("/api/mcp/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tool:"evolution.analyze-prompts",payload:{agentId:s,limit:5},context:{orgId:"org-1",userId:"user-1"}})});if(t.ok){const i=await t.json();i.latestPrompt?l({agentId:i.agentId,version:i.latestPrompt.version,promptText:i.latestPrompt.text,createdAt:i.latestPrompt.createdAt,createdBy:"system"}):l(null),i.recentRuns&&g(i.recentRuns.map(o=>{var x;return{id:o.runId,agent_id:i.agentId,prompt_version:((x=i.latestPrompt)==null?void 0:x.version)||1,kpi_name:"Performance",kpi_delta:o.kpiDelta,created_at:o.timestamp}}))}else l({agentId:s,version:42,promptText:"You are an optimized procurement agent. Focus on cost reduction while maintaining supplier relationships...",createdAt:new Date().toISOString(),createdBy:"EvolutionEngine"}),g([{id:1,agent_id:s,prompt_version:42,kpi_name:"Savings",kpi_delta:.15,created_at:new Date().toISOString()},{id:2,agent_id:s,prompt_version:41,kpi_name:"Savings",kpi_delta:.08,created_at:new Date(Date.now()-864e5).toISOString()}])}catch(t){p(t.message||"Failed to load agent data")}finally{c(!1)}};r.useEffect(()=>{b()},[s]);const a=n.length===0?0:n.reduce((i,o)=>i+o.kpi_delta,0)/n.length,u=a<0;return e.jsxDEV(W,{title:"Evolution & KPI Monitor",controls:e.jsxDEV("button",{onClick:b,className:"hover:text-[#00B5CB] transition-colors",children:e.jsxDEV(D,{size:14,className:N?"animate-spin":""},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:117,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:116,columnNumber:13},void 0),children:e.jsxDEV("div",{className:"flex flex-col h-full gap-4",children:[e.jsxDEV("div",{className:"relative",children:e.jsxDEV("select",{value:s,onChange:t=>f(t.target.value),className:"w-full p-2 bg-black/20 border border-white/10 rounded-lg text-xs text-white focus:outline-none focus:border-[#00B5CB]",children:[e.jsxDEV("option",{value:"procurement-agent",children:"Procurement Agent"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:129,columnNumber:13},void 0),e.jsxDEV("option",{value:"cma-agent",children:"CMA Agent"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:130,columnNumber:13},void 0),e.jsxDEV("option",{value:"srag-agent",children:"SRAG Agent"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:131,columnNumber:13},void 0),e.jsxDEV("option",{value:"pal-agent",children:"PAL Agent"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:132,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:124,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:123,columnNumber:9},void 0),m&&e.jsxDEV("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-xs",children:m},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:137,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxDEV("div",{className:"bg-white/5 border border-white/10 rounded-xl p-3",children:[e.jsxDEV("div",{className:"text-[10px] text-gray-400 uppercase mb-1",children:"Avg KPI Delta"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:145,columnNumber:17},void 0),e.jsxDEV("div",{className:`text-2xl font-bold ${a>=0?"text-green-400":"text-red-400"}`,children:[a>=0?"+":"",(a*100).toFixed(1),"%"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:146,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:144,columnNumber:13},void 0),e.jsxDEV("div",{className:`bg-white/5 border rounded-xl p-3 flex flex-col justify-center ${u?"border-red-500/30":"border-green-500/30"}`,children:[e.jsxDEV("div",{className:"text-[10px] text-gray-400 uppercase mb-1",children:"Status"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:151,columnNumber:17},void 0),e.jsxDEV("div",{className:"flex items-center gap-2 font-semibold text-sm text-white",children:[u?e.jsxDEV(v,{size:16,className:"text-red-400"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:153,columnNumber:40},void 0):e.jsxDEV(C,{size:16,className:"text-green-400"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:153,columnNumber:95},void 0),u?"Needs Refinement":"Performing Well"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:152,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:143,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex-1 min-h-0 flex flex-col",children:[e.jsxDEV("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 flex justify-between",children:["Current Prompt",d&&e.jsxDEV("span",{className:"bg-[#00B5CB]/20 text-[#00B5CB] px-1.5 rounded text-[9px]",children:["v",d.version]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:163,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:161,columnNumber:13},void 0),d?e.jsxDEV("div",{className:"bg-black/20 border border-white/10 rounded-lg p-3 flex-1 overflow-y-auto custom-scrollbar",children:[e.jsxDEV("p",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap leading-relaxed",children:d.promptText},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:168,columnNumber:21},void 0),e.jsxDEV("div",{className:"mt-3 pt-2 border-t border-white/5 text-[10px] text-gray-500 flex justify-between",children:[e.jsxDEV("span",{children:["By: ",d.createdBy]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:172,columnNumber:25},void 0),e.jsxDEV("span",{children:new Date(d.createdAt).toLocaleDateString()},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:173,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:171,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:167,columnNumber:17},void 0):e.jsxDEV("div",{className:"flex-1 flex items-center justify-center text-gray-500/50 text-xs border border-dashed border-white/10 rounded-lg",children:"No active prompt"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:177,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:160,columnNumber:9},void 0),e.jsxDEV("div",{className:"h-1/3 flex flex-col",children:[e.jsxDEV("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Recent Runs"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:185,columnNumber:14},void 0),e.jsxDEV("div",{className:"flex-1 overflow-y-auto space-y-2 custom-scrollbar pr-1",children:[n.map(t=>e.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-white/5 border border-white/5 hover:border-white/10 rounded-lg transition-colors",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("div",{className:`w-1 h-8 rounded-full ${t.kpi_delta>=0?"bg-green-500":"bg-red-500"}`},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:193,columnNumber:25},void 0),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"text-xs font-medium text-gray-200",children:t.kpi_name},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:195,columnNumber:29},void 0),e.jsxDEV("div",{className:"text-[10px] text-gray-500",children:["v",t.prompt_version," â€¢ ",new Date(t.created_at).toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:196,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:194,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:192,columnNumber:21},void 0),e.jsxDEV("span",{className:`text-xs font-bold ${t.kpi_delta>=0?"text-green-400":"text-red-400"}`,children:[t.kpi_delta>=0?"+":"",(t.kpi_delta*100).toFixed(1),"%"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:199,columnNumber:21},void 0)]},t.id,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:188,columnNumber:19},void 0)),n.length===0&&e.jsxDEV("div",{className:"text-center py-4 text-xs text-gray-500",children:"No runs recorded"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:205,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:186,columnNumber:14},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:184,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:121,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/EvolutionAgentWidget.tsx",lineNumber:113,columnNumber:5},void 0)};export{U as default};
