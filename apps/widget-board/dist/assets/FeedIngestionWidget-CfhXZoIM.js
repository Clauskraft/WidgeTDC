import{j as e}from"./index-DZEoTVC4.js";import{r as i}from"./ui-DyG0g13d.js";import{u as j}from"./useMCP-CI-td5l2.js";import"./vendor-Cv91Oj79.js";import"./graph-i8PIyU_l.js";import"./grid-BAREo1Ej.js";const v={feeds:[],pipelineStages:[{id:"ingest",name:"Ingest",service:"RSS Poller",status:"healthy",latencyMs:0},{id:"index",name:"Index",service:"Vector Store",status:"healthy",latencyMs:0}],normalizedDocuments:[],metrics:{documentsIndexed:0,ingestionLatency:0,dedupeRate:0,backlogMinutes:0},archive:{sizeBytes:0,retentionDays:30,objectCount:0},environment:{openSearchConnected:!1,minioConnected:!1}},I={healthy:"text-emerald-600",warning:"text-amber-600",error:"text-rose-600"},F={healthy:"Operational",warning:"Degraded",error:"Offline"},M=()=>{const{send:r}=j(),[a,o]=i.useState(""),[c,E]=i.useState("all"),[p,P]=i.useState(""),[u,V]=i.useState(!0),[t,D]=i.useState(v),[C,m]=i.useState(!1),[f,b]=i.useState(null),l=i.useCallback(async()=>{try{m(!0);const s=await r("agent-orchestrator","ingestion.status",{});if(s&&s.success)D(n=>({...n,metrics:{...n.metrics,documentsIndexed:s.totalDocuments||0},environment:{openSearchConnected:!0,minioConnected:!1}})),b(null);else throw new Error("Backend error")}catch(s){console.warn("Feed ingestion refresh failed",s),b("Backend connection failed")}finally{m(!1)}},[r]);i.useEffect(()=>{l()},[l]),i.useEffect(()=>{if(!u)return;const s=setInterval(l,1e4);return()=>clearInterval(s)},[u,l]);const d=t.feeds||[],W=t.normalizedDocuments||[],x=t.metrics,w=t.pipelineStages;i.useMemo(()=>{const s=a.trim().toLowerCase();return d.filter(n=>{const h=s.length===0||n.name.toLowerCase().includes(s),T=c==="all"?!0:n.threatLevel===c;return h&&T})},[a,c,d]);const g=d.find(s=>s.id===p)||d[0];return W.filter(s=>s.feedId===(g==null?void 0:g.id)).slice(0,3),e.jsxDEV("div",{className:"h-full flex flex-col -m-4","data-testid":"feed-ingestion-widget",children:[e.jsxDEV("header",{className:"p-4 bg-slate-950/80 text-white border-b border-slate-800",children:[e.jsxDEV("div",{className:"flex items-start justify-between gap-4 flex-wrap",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-xs uppercase tracking-[0.3em] text-white/60",children:"DATA PIPELINE"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:195,columnNumber:13},void 0),e.jsxDEV("h3",{className:"text-2xl font-semibold",children:"Feed Ingestion"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:196,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-white/80",children:"Real-time ingestion status from backend scrapers & agents."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:197,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:194,columnNumber:11},void 0),e.jsxDEV("div",{className:"text-right",children:e.jsxDEV("div",{className:"flex flex-col text-xs mt-2 gap-1",children:[C&&e.jsxDEV("span",{className:"text-white/70",children:"Syncing..."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:203,columnNumber:29},void 0),f&&e.jsxDEV("span",{className:"text-rose-300",children:f},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:204,columnNumber:32},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:202,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:201,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:193,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex gap-2 text-xs mt-3",children:e.jsxDEV("span",{className:`px-2 py-1 rounded-full ${t.environment.openSearchConnected?"bg-emerald-500/20 text-emerald-200":"bg-amber-500/20 text-amber-100"}`,children:["Vector Store ",t.environment.openSearchConnected?"Online":"Offline"]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:209,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:208,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:192,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex-1 grid grid-cols-12 gap-4 p-4 overflow-hidden bg-slate-50 dark:bg-slate-900/30",children:[e.jsxDEV("section",{className:"col-span-12 lg:col-span-5 h-full flex flex-col overflow-hidden border border-slate-200 dark:border-slate-800 rounded-2xl bg-white dark:bg-slate-900/70",children:[e.jsxDEV("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800",children:e.jsxDEV("h4",{className:"font-semibold text-sm",children:"Active Feeds"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:218,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:217,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex-1 flex items-center justify-center text-slate-500 text-sm p-4",children:d.length===0?"No active feeds reporting status.":"Feeds list here..."},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:220,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:216,columnNumber:9},void 0),e.jsxDEV("section",{className:"col-span-12 lg:col-span-7 h-full flex flex-col gap-4 overflow-hidden",children:[e.jsxDEV("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxDEV(N,{label:"Total Documents",helper:"Indexed in Vector DB",value:x.documentsIndexed.toLocaleString()},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:227,columnNumber:13},void 0),e.jsxDEV(N,{label:"Latency",helper:"Avg",value:`${x.ingestionLatency} ms`},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:232,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:226,columnNumber:11},void 0),e.jsxDEV("div",{className:"border border-slate-200 dark:border-slate-800 rounded-2xl bg-white dark:bg-slate-900/70 p-4 flex flex-col flex-1",children:[e.jsxDEV("h4",{className:"font-semibold text-sm mb-3",children:"Pipeline Status"},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:236,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-3",children:w.map(s=>e.jsxDEV("div",{className:"flex items-center gap-3",children:[e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"text-sm font-medium",children:s.name},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:241,columnNumber:23},void 0),e.jsxDEV("p",{className:"text-xs text-slate-500",children:s.service},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:242,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:240,columnNumber:21},void 0),e.jsxDEV("span",{className:`text-xs font-semibold ${I[s.status]}`,children:F[s.status]},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:244,columnNumber:21},void 0)]},s.id,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:239,columnNumber:19},void 0))},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:237,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:235,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:225,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:215,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:191,columnNumber:5},void 0)},N=({label:r,value:a,helper:o})=>e.jsxDEV("div",{className:"border border-slate-200 dark:border-slate-800 rounded-2xl bg-white dark:bg-slate-900/70 p-4",children:[e.jsxDEV("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:r},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:259,columnNumber:5},void 0),e.jsxDEV("p",{className:"text-2xl font-semibold mt-1",children:a},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:260,columnNumber:5},void 0),o&&e.jsxDEV("p",{className:"text-xs text-slate-400",children:o},void 0,!1,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:261,columnNumber:16},void 0)]},void 0,!0,{fileName:"C:/Users/claus/Projects/WidgeTDC/WidgeTDC/apps/widget-board/widgets/FeedIngestionWidget.tsx",lineNumber:258,columnNumber:3},void 0);export{M as default};
